---
layout: post
title: 6 个重构方法可帮你提升 80% 的代码质量
date: 2014/02/17 02:20:00
categories: 
- 技术
tags: 
- 重构
---

英文原文： [Top 6 Refactoring Patterns to Help You Score 80% in Code Quality][1]

在过去做了不少代码走读，发现了一些代码质量上比较普遍的问题，以下是其中的前五名：  

1. 臃肿的类: 类之所以会臃肿，是因为开发者缺乏对最基本的编码原则，即“单一职责原则”（SRP）的理解。这些类往往会变得很臃肿，是由于不同的且在功能上缺少关联的方法都放在了相同的类里面。  

2. 长方法: 方法之所以会变得很长主要是有以下几个原因： 许多没有关联性的、功能复杂的模块的代码都放在相同的方法内。这主要是开发者缺乏SRP的概念。

多种条件都放在同一个方法内，这在长方法内经常会发生的。这是由于缺乏McCabe代码复杂度和SRP的概念的比较。

3. 大量的传参: 我经常遇到这几种情况，一些方法跟另一些方法进行交互，或者调用另一些方法的时候传入大量的参数。这就会出现如果更改了其中一个参数，就得在多个方法内进行更改。

4. 常量值无处不在: 经常会发现开发者（尤其是新手）会使用一些具有明确含义的常量值（主要是魔鬼数字），但没有给它们赋予合适的常量变量。这会降低代码的可读性和可理解性。  

5. 模糊的方法名: 许多时候，以下取的方法名会影响代码的可读性和可理解性： 模糊的不具有任何意义的方法名 技术性的，却没有提及相关领域的名称 6个处理上面代码异味的重构方法（手法）  以下是6个可以用来帮助你解决80%（80-20原则）的代码质量问题的重构方法，并能帮助你成为一个更优秀的开发者。  

1.  [抽离方法][2]：正如上面提到的，像“臃肿的类”（一个类提供了本该有几个类提供的功能）这种代码异味应该将原有类中的方法和属性移动到适当数目的新类中去。旧类中对应新类的方法和属性应该被移除。另外，有时候一些类过于臃肿是因为它包含了被其他类使用本应该是其他类的成员方法的成员方法。这些方法也应该被迁移到合适的类中。

2.  [提取方法][3]：像上面提到的“过长的方法”这种代码异味可以通过从旧方法中提取代码到一个或多个新方法中消除。

3.  [分离条件][4]：许多时候，一个方法很长是因为包含好几个分支语句（if-else）。这些分支条件可以被提取和移动到几个单独的方法中。这确实能大大改善代码可读性和可理解性。

4.  [引入参数对象][5] [保留全局对象][6]：在我做代码审查时发现另外一个很常见的情况 - 好几个参数被传入方法。问题主要与需要从已有方法中增加或者移除一个方法参数有关。在这种场景，建议将相关方法参数组成一个对象（引入参数对象），让方法传递这些对象而不是每个单独的参数。

5.  [用符号常量替换魔法数字][7]：对于有意义的并且到处被使用的字面常量，应该为它们分配一个命名常量。这能大大增强代码可读性和可理解性。

6.  [重命名方法][8]：正如上面提到的，模糊不清的方法名会影响代码的可使用性。这些模糊不清的名称应该重命名为有意义的可能与业务术语有关的名称，来帮助开发者通过业务上下文更好地理解代码。这很需要技巧并且要求开发者与业务专家一起协作来理清代码需要满足的业务需求。有趣的是，这种重构方法看起来似乎非常容易理解，但是常常被许多开发者忽视，虽然在Eclipse这种IDE的refactor菜单项中经常出现这一项。

译文：开源中国

 [1]: http://vitalflux.com/top-6-refactoring-patterns-to-help-you-score-80-in-code-quality/

 [2]: http://www.refactoring.com/catalog/moveMethod.html

 [3]: http://www.refactoring.com/catalog/extractMethod.html

 [4]: http://www.refactoring.com/catalog/decomposeConditional.html

 [5]: http://www.refactoring.com/catalog/introduceParameterObject.html

 [6]: http://www.refactoring.com/catalog/preserveWholeObject.html

 [7]: http://www.refactoring.com/catalog/replaceMagicNumberWithSymbolicConstant.html

 [8]: http://www.refactoring.com/catalog/renameMethod.html
